id: 9c5c9f16-2335-55ca-9c85-9aa1df1a66af
name: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation
description: This detects file modifications to ASPX and ASHX files within the root of the App_Extensions directory, which is allowed by a ZipSlip vulnerability in versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708. - This will occur legitimately as well and will result in some benign activity.
severity: Medium
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- Persistence
query: |-
  DeviceFileEvents
  | where (InitiatingProcessFolderPath endswith "\\ScreenConnect.Service.exe" and ((FolderPath contains "ScreenConnect\\App_Extensions\\" and FolderPath contains ".ashx") or (FolderPath contains "ScreenConnect\\App_Extensions\\" and FolderPath contains ".aspx"))) and (not(FolderPath =~ "*ScreenConnect\\App_Extensions\*\*"))
version: 1.0.0
kind: Scheduled
entityMappings:
- entityType: Process
  fieldMappings:
  - identifier: ProcessPath
    columnName: FolderPath
- entityType: File
  fieldMappings:
  - identifier: Directory
    columnName: FolderPath
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceFileEvents
