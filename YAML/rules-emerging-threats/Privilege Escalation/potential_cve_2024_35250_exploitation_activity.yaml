id: 3c9a99de-4fad-5fb1-9758-1233d91d01f1
name: Potential CVE-2024-35250 Exploitation Activity
description: Detects potentially suspicious loading of "ksproxy.ax", which may indicate an attempt to exploit CVE-2024-35250. - Legitimate applications that use Windows Stream Interface APIs. - Media applications that use DirectShow filters.
severity: Medium
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- PrivilegeEscalation
query: |-
  DeviceImageLoadEvents
  | where FolderPath endswith "\\ksproxy.ax" and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\"))) and (not((InitiatingProcessFolderPath endswith "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe" or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Discord\\app-" and InitiatingProcessFolderPath contains "\\Discord.exe") or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Mozilla Firefox\\firefox.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Programs\\Opera\\opera.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Roaming\\Zoom\\bin\\Zoom.exe")))
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1068
entityMappings:
- entityType: Process
  fieldMappings:
  - identifier: ProcessPath
    columnName: FolderPath
- entityType: File
  fieldMappings:
  - identifier: Directory
    columnName: FolderPath
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceImageLoadEvents
