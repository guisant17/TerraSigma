id: 72e1575f-ed8b-55dc-8ff6-9e45621e1e59
name: Ping Hex IP
description: Detects a ping command that uses a hex encoded IP address - Unlikely, because no sane admin pings IP addresses in a hexadecimal form
severity: High
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- DefenseEvasion
query: |-
  DeviceProcessEvents
  | where ProcessCommandLine matches regex "0x[a-fA-F0-9]{8}" and FolderPath endswith "\\ping.exe"
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1140
- T1027
entityMappings:
- entityType: Process
  fieldMappings:
  - identifier: CommandLine
    columnName: ProcessCommandLine
  - identifier: ProcessPath
    columnName: FolderPath
- entityType: File
  fieldMappings:
  - identifier: Directory
    columnName: FolderPath
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceProcessEvents
