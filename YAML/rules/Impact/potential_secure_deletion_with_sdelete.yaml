id: d6aa57bf-04fe-5af5-91a2-064154651428
name: Potential Secure Deletion with SDelete
description: Detects files that have extensions commonly seen while SDelete is used to wipe files. - Legitimate usage of SDelete - Files that are interacted with that have these extensions legitimately
severity: Medium
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- Impact
- DefenseEvasion
query: |-
  DeviceRegistryEvents
  | where RegistryKey endswith ".AAA" or RegistryKey endswith ".ZZZ"
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1070
- T1027
- T1485
- T1553
entityMappings:
- entityType: RegistryKey
  fieldMappings:
  - identifier: Key
    columnName: RegistryKey
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceRegistryEvents
