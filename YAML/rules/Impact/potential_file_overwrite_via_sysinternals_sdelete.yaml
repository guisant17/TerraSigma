id: 21133f38-fcf7-5ac3-8284-62459985f922
name: Potential File Overwrite Via Sysinternals SDelete
description: Detects the use of SDelete to erase a file not the free space
severity: High
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- Impact
query: |-
  DeviceProcessEvents
  | where ProcessVersionInfoOriginalFileName =~ "sdelete.exe" and (not((ProcessCommandLine contains " -h" or ProcessCommandLine contains " -c" or ProcessCommandLine contains " -z" or ProcessCommandLine contains " /?")))
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1485
entityMappings:
- entityType: Process
  fieldMappings:
  - identifier: CommandLine
    columnName: ProcessCommandLine
  - identifier: ProcessName
    columnName: FileName
- entityType: File
  fieldMappings:
  - identifier: Name
    columnName: FileName
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceProcessEvents
