id: fbe8aa03-ae9b-569d-b791-8fe97859ec02
name: Remote Access Tool - AnyDesk Piped Password Via CLI
description: Detects piping the password to an anydesk instance via CMD and the '--set-password' flag. - Legitimate piping of the password to anydesk - Some FP could occur with similar tools that uses the same command line '--set-password'
severity: Medium
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- CommandAndControl
query: |-
  DeviceProcessEvents
  | where ProcessCommandLine contains "/c " and ProcessCommandLine contains "echo " and ProcessCommandLine contains ".exe --set-password"
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1219
entityMappings:
- entityType: Process
  fieldMappings:
  - identifier: CommandLine
    columnName: ProcessCommandLine
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceProcessEvents
