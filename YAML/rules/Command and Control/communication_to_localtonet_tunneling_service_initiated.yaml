id: 667ea46a-ed40-5d6e-bde2-47196535b4c1
name: Communication To LocaltoNet Tunneling Service Initiated
description: Detects an executable initiating a network connection to "LocaltoNet" tunneling sub-domains. LocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet. Attackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls. - Legitimate use of the LocaltoNet service.
severity: High
queryFrequency: PT1H
queryPeriod: PT1H
triggerOperator: gt
triggerThreshold: 0
tactics:
- CommandAndControl
query: |-
  DeviceNetworkEvents
  | where RemoteUrl endswith ".localto.net" or RemoteUrl endswith ".localtonet.com"
version: 1.0.0
kind: Scheduled
relevantTechniques:
- T1572
- T1090
- T1102
entityMappings:
- entityType: URL
  fieldMappings:
  - identifier: Url
    columnName: RemoteUrl
requiredDataConnectors:
- connectorId: MicrosoftThreatProtection
  dataTypes:
  - DeviceNetworkEvents
