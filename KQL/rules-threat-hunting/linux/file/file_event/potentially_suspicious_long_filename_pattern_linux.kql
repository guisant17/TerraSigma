// Title: Potentially Suspicious Long Filename Pattern - Linux
// Author: @kostastsale
// Date: 2025-11-22
// Level: low
// Description: Detects the creation of files with unusually long filenames (100 or more characters), which may indicate obfuscation techniques used by malware such as VShell.
// This is a hunting rule to identify potential threats that use long filenames to evade detection. Keep in mind that on a legitimate system, such long filenames can and are common. Run this detection in the context of threat hunting rather than alerting.
// Adjust the threshold of filename length as needed based on your environment.
// MITRE Tactic: Execution
// Tags: attack.execution, attack.t1059.004, attack.defense-evasion, attack.t1027, detection.threat-hunting
// False Positives:
//   - Legitimate files with long filenames.

DeviceFileEvents
| where FolderPath matches regex "[^/]{100,}$" and (not((FolderPath startswith "/run/systemd/units/invocation:systemd-fsck@" or FolderPath startswith "/sys/firmware/" or FolderPath startswith "/var/log/journal/")))