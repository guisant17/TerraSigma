// Title: Potential BlackByte Ransomware Activity
// Author: Florian Roth (Nextron Systems)
// Date: 2022-02-25
// Level: high
// Description: Detects command line patterns used by BlackByte ransomware in different operations
// MITRE Tactic: Execution
// Tags: attack.execution, attack.defense-evasion, attack.impact, attack.t1485, attack.t1498, attack.t1059.001, attack.t1140, detection.emerging-threats

DeviceProcessEvents
| where (ProcessCommandLine contains " -single " and FolderPath startswith "C:\\Users\\Public\\") or (ProcessCommandLine contains "del C:\\Windows\\System32\\Taskmgr.exe" or ProcessCommandLine contains ";Set-Service -StartupType Disabled $" or ProcessCommandLine contains "powershell -command \"$x =[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(" or ProcessCommandLine contains " do start wordpad.exe /p ")