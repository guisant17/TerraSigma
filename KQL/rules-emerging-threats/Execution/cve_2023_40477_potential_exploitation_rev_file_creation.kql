// Title: CVE-2023-40477 Potential Exploitation - .REV File Creation
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-08-31
// Level: low
// Description: Detects the creation of ".rev" files by WinRAR. Could be indicative of potential exploitation of CVE-2023-40477. Look for a suspicious execution shortly after creation or a WinRAR application crash.
// MITRE Tactic: Execution
// Tags: attack.execution, cve.2023-40477, detection.emerging-threats
// False Positives:
//   - Legitimate extraction of multipart or recovery volumes ZIP files

DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessFolderPath endswith "\\WinRAR.exe") and FolderPath endswith ".rev"