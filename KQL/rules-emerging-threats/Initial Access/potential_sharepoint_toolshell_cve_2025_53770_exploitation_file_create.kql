// Title: Potential SharePoint ToolShell CVE-2025-53770 Exploitation - File Create
// Author: Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2025-07-21
// Level: critical
// Description: Detects the creation of file such as spinstall0.aspx which may indicate successful exploitation of CVE-2025-53770.
// CVE-2025-53770 is a zero-day vulnerability in SharePoint that allows remote code execution.
// MITRE Tactic: Initial Access
// Tags: attack.initial-access, attack.t1190, cve.2025-53770, detection.emerging-threats

DeviceFileEvents
| where (FolderPath contains "\\15\\TEMPLATE\\LAYOUTS\\" or FolderPath contains "\\16\\TEMPLATE\\LAYOUTS\\") and (FolderPath endswith "\\spinstall.aspx" or (FolderPath contains "\\spinstall" and FolderPath contains ".aspx") or FolderPath endswith "\\debug_dev.js") and (FolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\" or FolderPath startswith "C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\Web Server Extensions\\")