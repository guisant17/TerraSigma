// Title: Commvault QLogin Argument Injection Authentication Bypass (CVE-2025-57791)
// Author: X__Junior (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2025-10-20
// Level: high
// Description: Detects the use of argument injection in the Commvault qlogin command - potential exploitation for CVE-2025-57791.
// An attacker can inject the `-localadmin` parameter via the password field to bypass authentication and gain a privileged token.
// MITRE Tactic: Initial Access
// Tags: attack.initial-access, attack.t1190, detection.emerging-threats, cve.2025-57791

DeviceProcessEvents
| where ProcessCommandLine contains "qlogin" and ProcessCommandLine contains " -cs " and ProcessCommandLine contains " -localadmin" and ProcessCommandLine contains " -clp " and ProcessCommandLine contains "_localadmin__"