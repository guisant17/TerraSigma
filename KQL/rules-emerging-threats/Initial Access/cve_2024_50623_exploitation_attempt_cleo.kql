// Title: CVE-2024-50623 Exploitation Attempt - Cleo
// Author: Tanner Filip, Austin Worline, Chad Hudson, Matt Anderson
// Date: 2024-12-09
// Level: high
// Description: Detects exploitation attempt of Cleo's CVE-2024-50623 by looking for a "cmd.exe" process spawning from the Celo software suite with suspicious Powershell commandline.
// MITRE Tactic: Initial Access
// Tags: attack.initial-access, attack.execution, attack.t1190, cve.2024-50623, detection.emerging-threats
// False Positives:
//   - Unlikely

DeviceProcessEvents
| where (ProcessCommandLine contains "powershell" or ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -EncodedCommand" or ProcessCommandLine contains ".Download") and FolderPath endswith "\\cmd.exe" and (InitiatingProcessCommandLine contains "Harmony" or InitiatingProcessCommandLine contains "lexicom" or InitiatingProcessCommandLine contains "VersaLex" or InitiatingProcessCommandLine contains "VLTrader") and InitiatingProcessFolderPath endswith "\\javaw.exe"