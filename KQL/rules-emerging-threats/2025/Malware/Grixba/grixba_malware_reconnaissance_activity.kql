// Title: Grixba Malware Reconnaissance Activity
// Author: yxinmiracle, Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2025-11-26
// Level: high
// Description: Detects execution of the Grixba reconnaissance tool based on suspicious command-line parameter combinations.
// This tool is used by the Play ransomware group for network enumeration, data gathering, and event log clearing.
// MITRE Tactic: Reconnaissance
// Tags: attack.reconnaissance, attack.t1595.001, attack.discovery, attack.t1046, detection.emerging-threats
// False Positives:
//   - Legitimate tools that use similar command-line argument structures (e.g., a tool with '--mode scan' and '--input file.txt') could trigger this rule. However, the specific combinations are indicative of reconnaissance or defense evasion.

DeviceProcessEvents
| where (ProcessCommandLine contains "-i " or ProcessCommandLine contains "-input " or ProcessCommandLine contains "-i:" or ProcessCommandLine contains "-input:") and (ProcessCommandLine contains ":f " or ProcessCommandLine contains ":r " or ProcessCommandLine contains ":s " or ProcessCommandLine contains " f " or ProcessCommandLine contains " r " or ProcessCommandLine contains " s ") and (ProcessCommandLine contains "-m " or ProcessCommandLine contains "-mode " or ProcessCommandLine contains "-m:" or ProcessCommandLine contains "-mode:") and (ProcessCommandLine contains "scan " or ProcessCommandLine contains "scanall ")