// Title: Non-Standard Nsswitch.Conf Creation - Potential CVE-2025-32463 Exploitation
// Author: Swachchhanda Shrawn Poudel (Nextron Systems)
// Date: 2025-10-02
// Level: high
// Description: Detects the creation of nsswitch.conf files in non-standard directories, which may indicate exploitation of CVE-2025-32463.
// This vulnerability requires an attacker to create a nsswitch.conf in a directory that will be used during sudo chroot operations.
// When sudo executes, it loads malicious shared libraries from user-controlled locations within the chroot environment,
// potentially leading to arbitrary code execution and privilege escalation.
// MITRE Tactic: Privilege Escalation
// Tags: attack.privilege-escalation, attack.t1068, cve.2025-32463, detection.emerging-threats
// False Positives:
//   - Backup locations

DeviceFileEvents
| where FolderPath endswith "/etc/nsswitch.conf" and (not(FolderPath =~ "/etc/nsswitch.conf"))