// Title: Commvault QLogin with PublicSharingUser and GUID Password (CVE-2025-57788)
// Author: Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2025-10-20
// Level: medium
// Description: Detects a qlogin.exe command attempting to authenticate as the internal `_+_PublicSharingUser_` using a GUID as the password.
// This could be an indicator of an attacker exploiting CVE-2025-57788 to gain initial access using leaked credentials.
// MITRE Tactic: Privilege Escalation
// Tags: attack.privilege-escalation, attack.persistence, attack.defense-evasion, attack.initial-access, attack.t1078.001, detection.emerging-threats, cve.2025-57788
// False Positives:
//   - Legitimate administrative scripts that use the `_+_PublicSharingUser_` account for valid purposes.

DeviceProcessEvents
| where (ProcessCommandLine contains "qlogin" and ProcessCommandLine contains "_+_PublicSharingUser_") and ProcessCommandLine matches regex "[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}"