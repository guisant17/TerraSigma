// Title: FlowCloud Registry Markers
// Author: NVISO
// Date: 2020-06-09
// Level: critical
// Description: Detects FlowCloud malware registry markers from threat group TA410.
// The malware stores its configuration in the registry alongside drivers utilized by the malware's keylogger components.
// MITRE Tactic: Defense Evasion
// Tags: attack.defense-evasion, attack.persistence, attack.t1112, detection.emerging-threats
// False Positives:
//   - Unlikely

DeviceRegistryEvents
| where RegistryKey contains "\\HARDWARE\\{2DB80286-1784-48b5-A751-B6ED1F490303}" or RegistryKey contains "\\HARDWARE\\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}" or RegistryKey contains "\\HARDWARE\\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}" or RegistryKey endswith "\\SYSTEM\\Setup\\PrintResponsor*"