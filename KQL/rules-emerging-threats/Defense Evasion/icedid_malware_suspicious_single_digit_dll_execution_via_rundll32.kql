// Title: IcedID Malware Suspicious Single Digit DLL Execution Via Rundll32
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-08-31
// Level: high
// Description: Detects RunDLL32.exe executing a single digit DLL named "1.dll" with the export function "DllRegisterServer". This behaviour was often seen used by malware and especially IcedID
// MITRE Tactic: Defense Evasion
// Tags: attack.defense-evasion, attack.t1218.011, detection.emerging-threats

DeviceProcessEvents
| where (ProcessCommandLine endswith "\\1.dll, DllRegisterServer" or ProcessCommandLine endswith " 1.dll, DllRegisterServer") and FolderPath endswith "\\rundll32.exe"