// Title: Rhadamanthys Stealer Module Launch Via Rundll32.EXE
// Author: TropChaud
// Date: 2023-01-26
// Level: medium
// Description: Detects the use of Rundll32 to launch an NSIS module that serves as the main stealer capability of Rhadamanthys infostealer, as observed in reports and samples in early 2023
// MITRE Tactic: Defense Evasion
// Tags: attack.defense-evasion, attack.t1218.011, detection.emerging-threats

DeviceProcessEvents
| where ProcessCommandLine contains "nsis_uns" and ProcessCommandLine contains "PrintUIEntry" and (ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or FolderPath endswith "\\rundll32.exe")