// Title: COLDSTEEL RAT Anonymous User Process Execution
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-04-30
// Level: high
// Description: Detects the creation of a process executing as user called "ANONYMOUS" seen used by the "MileStone2016" variant of COLDSTEEL
// MITRE Tactic: Persistence
// Tags: attack.persistence, attack.defense-evasion, detection.emerging-threats

DeviceProcessEvents
| where (InitiatingProcessFolderPath contains "\\Windows\\System32\\" or InitiatingProcessFolderPath contains "\\AppData\\") and AccountName contains "ANONYMOUS"