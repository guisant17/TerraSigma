// Title: Potential CVE-2021-40444 Exploitation Attempt
// Author: Florian Roth (Nextron Systems), @neonprimetime
// Date: 2021-09-08
// Level: high
// Description: Detects potential exploitation of CVE-2021-40444 via suspicious process patterns seen in in-the-wild exploitations
// MITRE Tactic: Execution
// Tags: attack.execution, attack.t1059, cve.2021-40444, detection.emerging-threats

DeviceProcessEvents
| where (FolderPath endswith "\\control.exe" and (InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\excel.exe")) and (not((ProcessCommandLine endswith "\\control.exe input.dll" or ProcessCommandLine endswith "\\control.exe\" input.dll")))