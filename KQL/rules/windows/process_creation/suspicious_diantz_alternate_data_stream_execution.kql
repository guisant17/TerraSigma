// Title: Suspicious Diantz Alternate Data Stream Execution
// Author: frack113
// Date: 2021-11-26
// Level: medium
// Description: Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.
// MITRE Tactic: Defense Evasion
// Tags: attack.defense-evasion, attack.t1564.004
// False Positives:
//   - Very Possible

DeviceProcessEvents
| where (ProcessCommandLine contains "diantz.exe" and ProcessCommandLine contains ".cab") and ProcessCommandLine matches regex ":[^\\\\]"