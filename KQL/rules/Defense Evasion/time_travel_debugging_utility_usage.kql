// Title: Time Travel Debugging Utility Usage
// Author: Ensar Åžamil, @sblmsrsn, @oscd_initiative
// Date: 2020-10-06
// Level: high
// Description: Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.
// MITRE Tactic: Defense Evasion
// Tags: attack.defense-evasion, attack.credential-access, attack.t1218, attack.t1003.001
// False Positives:
//   - Legitimate usage by software developers/testers

DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\tttracer.exe"