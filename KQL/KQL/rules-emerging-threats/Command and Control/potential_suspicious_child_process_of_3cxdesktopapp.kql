// Title: Potential Suspicious Child Process Of 3CXDesktopApp
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-03-29
// Level: high
// Description: Detects potential suspicious child processes of "3CXDesktopApp.exe". Which could be related to the 3CXDesktopApp supply chain compromise
// MITRE Tactic: Command and Control
// Tags: attack.command-and-control, attack.execution, attack.defense-evasion, attack.t1218, detection.emerging-threats

DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\3CXDesktopApp.exe"