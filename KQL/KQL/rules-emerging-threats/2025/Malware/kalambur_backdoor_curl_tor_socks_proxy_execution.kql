// Title: Kalambur Backdoor Curl TOR SOCKS Proxy Execution
// Author: Arda Buyukkaya (EclecticIQ)
// Date: 2025-02-11
// Level: high
// Description: Detects the execution of the "curl.exe" command, referencing "SOCKS" and ".onion" domains, which could be indicative of Kalambur backdoor activity.
// MITRE Tactic: Execution
// Tags: attack.execution, attack.command-and-control, attack.t1090, attack.t1573, attack.t1071.001, attack.t1059.001, attack.s0183, detection.emerging-threats
// False Positives:
//   - Unlikely

DeviceProcessEvents
| where FolderPath endswith "\\curl.exe" and ProcessCommandLine contains ".onion" and (ProcessCommandLine contains "socks5h://" or ProcessCommandLine contains "socks5://" or ProcessCommandLine contains "socks4a://")