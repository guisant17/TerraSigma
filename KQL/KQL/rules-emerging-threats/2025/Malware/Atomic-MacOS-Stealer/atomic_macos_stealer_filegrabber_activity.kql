// Title: Atomic MacOS Stealer - FileGrabber Activity
// Author: Jason Phang Vern - Onn, Robbin Ooi Zhen Heng (Gen Digital)
// Date: 2025-11-22
// Level: high
// Description: Detects suspicious activity associated with Atomic MacOS Stealer (Amos) campaigns, including execution of FileGrabber and curl-based POST requests used for data exfiltration. The rule identifies either the execution of FileGrabber targeting /tmp or the use of curl to POST sensitive user data (including files such as /tmp/out.zip) to remote servers, which are key indicators of Amos infostealer activity.
// MITRE Tactic: Execution
// Tags: attack.execution, attack.t1059.002, detection.emerging-threats

DeviceProcessEvents
| where (ProcessCommandLine contains "curl" and ProcessCommandLine contains "POST" and ProcessCommandLine contains "user:" and ProcessCommandLine contains "-H " and ProcessCommandLine contains "BuildID" and ProcessCommandLine contains "file=@/tmp/out.zip" and ProcessCommandLine contains "cl: 0") or (ProcessCommandLine contains "FileGrabber" and ProcessCommandLine contains "/tmp")