// Title: DarkSide Ransomware Pattern
// Author: Florian Roth (Nextron Systems)
// Date: 2021-05-14
// Level: critical
// Description: Detects DarkSide Ransomware and helpers
// MITRE Tactic: Execution
// Tags: attack.execution, attack.t1204, detection.emerging-threats
// False Positives:
//   - UAC bypass method used by other malware

DeviceProcessEvents
| where (ProcessCommandLine contains "=[char][byte]('0x'+" or ProcessCommandLine contains " -work worker0 -path ") or (FolderPath contains "\\AppData\\Local\\Temp\\" and InitiatingProcessCommandLine contains "DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}")