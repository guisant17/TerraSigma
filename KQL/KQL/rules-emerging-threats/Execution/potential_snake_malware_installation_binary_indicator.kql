// Title: Potential SNAKE Malware Installation Binary Indicator
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-05-04
// Level: high
// Description: Detects a specific binary name seen used by SNAKE malware during its installation as described by CISA in their report
// MITRE Tactic: Execution
// Tags: attack.execution, detection.emerging-threats
// False Positives:
//   - Unlikely

DeviceProcessEvents
| where (FolderPath endswith "\\jpsetup.exe" or FolderPath endswith "\\jpinst.exe") and (not((ProcessCommandLine =~ "" or (ProcessCommandLine in~ ("jpinst.exe", "jpinst", "jpsetup.exe", "jpsetup")) or isnull(ProcessCommandLine))))