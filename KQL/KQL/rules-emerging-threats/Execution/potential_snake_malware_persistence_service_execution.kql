// Title: Potential SNAKE Malware Persistence Service Execution
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2023-05-04
// Level: high
// Description: Detects a specific child/parent process relationship indicative of a "WerFault" process running from the "WinSxS" as a service. This could be indicative of potential SNAKE malware activity as reported by CISA.
// MITRE Tactic: Execution
// Tags: attack.execution, detection.emerging-threats

DeviceProcessEvents
| where FolderPath endswith "\\WerFault.exe" and FolderPath startswith "C:\\Windows\\WinSxS\\" and InitiatingProcessFolderPath endswith "\\services.exe"