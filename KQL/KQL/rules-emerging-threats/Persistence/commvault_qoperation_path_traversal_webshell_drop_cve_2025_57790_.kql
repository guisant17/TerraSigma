// Title: Commvault QOperation Path Traversal Webshell Drop (CVE-2025-57790)
// Author: Swachchhanda Shrawan Poudel (Nextron Systems)
// Date: 2025-10-20
// Level: high
// Description: Detects the use of qoperation.exe with the -file argument to write a JSP file to the webroot, indicating a webshell drop.
// This is a post-authentication step corresponding to CVE-2025-57790.
// MITRE Tactic: Persistence
// Tags: attack.persistence, attack.t1505.003, detection.emerging-threats, cve.2025-57790

DeviceProcessEvents
| where ProcessCommandLine contains "qoperation" and ProcessCommandLine contains "exec" and ProcessCommandLine contains " -af " and ProcessCommandLine contains ".xml " and ProcessCommandLine contains "\\Apache\\webapps\\ROOT\\" and ProcessCommandLine contains ".jsp"