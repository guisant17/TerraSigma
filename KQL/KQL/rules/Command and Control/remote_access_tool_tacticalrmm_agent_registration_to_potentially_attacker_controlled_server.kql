// Title: Remote Access Tool - TacticalRMM Agent Registration to Potentially Attacker-Controlled Server
// Author: Ahmed Nosir (@egycondor)
// Date: 2025-05-29
// Level: medium
// Description: Detects TacticalRMM agent installations where the --api, --auth, and related flags are used on the command line.
// These parameters configure the agent to connect to a specific RMM server with authentication, client ID, and site ID.
// This technique could indicate a threat actor attempting to register the agent with an attacker-controlled RMM infrastructure silently.
// MITRE Tactic: Command and Control
// Tags: attack.command-and-control, attack.t1219, attack.t1105
// False Positives:
//   - Legitimate system administrator deploying TacticalRMM

DeviceProcessEvents
| where (ProcessCommandLine contains "--api" and ProcessCommandLine contains "--auth" and ProcessCommandLine contains "--client-id" and ProcessCommandLine contains "--site-id" and ProcessCommandLine contains "--agent-type") and FolderPath contains "\\TacticalAgent\\tacticalrmm.exe"